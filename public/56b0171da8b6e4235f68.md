---
title: ã€streamlit/åˆ†æžå¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«ã€‘streamlitã‚’å‹•ã‹ã—ã¦ã¿ãŸã®ã¨ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¯ãƒ©ã‚¦ãƒ‰ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã¿ã¾ã—ãŸ
tags:
  - Python
  - Python3
  - åˆ†æž
  - Streamlit
private: false
updated_at: '2025-06-19T19:09:04+09:00'
id: 56b0171da8b6e4235f68
organization_url_name: null
slide: false
ignorePublish: false
---
ã€€ãƒ‡ãƒ¼ã‚¿åˆ†æžã®ç•Œéšˆã§ã¯ã€Streamlitã¨ã„ã†ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒæœ‰åã§ã™ã€‚ã“ã®ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¯ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ãƒ»ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ä½¿ç”¨ã•ã‚Œã€ç‰¹å¾´ã¨ã—ã¦ã¯è¶…é«˜é€Ÿé–‹ç™ºã€‚1ãƒ•ã‚¡ã‚¤ãƒ«ã§Web UIä½œæˆå¯èƒ½ã§ã‚ã‚‹ç‚¹ã‚‚ç‰¹å¾´çš„ã§ã™ã€‚

## WSLç’°å¢ƒã«pythonä»®æƒ³ç’°å¢ƒã‚’å°Žå…¥
ã€€pythonã®ä»®æƒ³ç’°å¢ƒã®æ§‹ç¯‰ã®ç‚ºã«ä¸‹è¨˜ã®ãƒšãƒ¼ã‚¸ãªã©ã‚’å‚è€ƒã«WSLç’°å¢ƒã«anacondaã‚’å°Žå…¥
 
https://qiita.com/lighlighlighlighlight/items/8f624751df808d89d48c

ã•ã¦ã€è‡ªèº«ã®pythonä»®æƒ³ç’°å¢ƒã‚’ç«‹ã¡ä¸Šã’ã¦ã¿ã¾ã™ã€‚
æœ€åˆã«requirementsãƒ•ã‚¡ã‚¤ãƒ«ã‚’æº–å‚™ã—ã¦ãŠãã¾ã™ã€‚

```bash
~/anaconda3/envs/stremlit_env$ cat requirements.txt
numpy==1.26.4
matplotlib== 3.9.2
pandas== 2.2.3
seaborn== 0.13.2
streamlit== 1.39.0
scikit-learn== 1.5.2
plotly== 5.24.1
```
ä¸‹è¨˜ã§ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆã—ã¾ã™ã€‚
```bash
conda create -n my_env python=3.10 --file requirements.txt
```
ä»®æƒ³ç’°å¢ƒã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
```bash
conda activate my_env
```
ãã—ãŸã‚‰ã“ã®ä¸­ã§streamlitã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã¾ã™ã€‚
```bash
pip install streamlit==1.39.0
```

## ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã¿ã‚‹
ä¸‹è¨˜ã®streamlitã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ãŸã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã¿ã¾ã™ã€‚
é–¢æ•°åž‹ã«è¨˜è¼‰ã—ã¦ãŠã‚Šã€ä¸Šã‹ã‚‰é †ã«Webã‚¢ãƒ—ãƒªã®ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```python.py
import streamlit as st
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import fetch_california_housing
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error

# Set the theme for seaborn plots
sns.set_theme()

# Display a title
st.title("Linear Regression on California Housing Prices")


# Load the California Housing dataset
dataset = fetch_california_housing()
df = pd.DataFrame(dataset.data, columns=dataset.feature_names)
df["PRICE"] = dataset.target

# View Dataset and Description Section
with st.expander("View Dataset and Description"):
    # Display dataset when checkbox is ON
    if st.checkbox("View dataset in table data format"):
        st.dataframe(df)

    # Show each column description when checkbox is ON.
    if st.checkbox("Show each column name and its description"):
        st.markdown(
            """
            ### Column name and its Description
            - **MedInc**: Median income in block group
            - **HouseAge**: Median house age in block group
            - **AveRooms**: Average number of rooms per household
            - **AveBedrms**: Average number of bedrooms per household
            - **Population**: Population in block group
            - **AveOccup**: Average household size
            - **Latitude**: Block group latitude
            - **Longitude**: Block group longitude
            """
        )

# Outlier removal option
with st.expander("Outlier Removal"):
    remove_outliers = st.checkbox("Remove outliers from target variable (PRICE)")

    if remove_outliers:
        Q1 = df["PRICE"].quantile(0.25)
        Q3 = df["PRICE"].quantile(0.75)
        IQR = Q3 - Q1
        lower_bound = Q1 - 1.5 * IQR
        upper_bound = Q3 + 1.5 * IQR
        initial_size = df.shape[0]
        df = df[(df["PRICE"] >= lower_bound) & (df["PRICE"] <= upper_bound)]
        removed_size = initial_size - df.shape[0]
        st.write(f"Removed {removed_size} outliers from target variable.")

# Plot relationship between target and explanatory variables
if st.checkbox("Plot the relation between target and explanatory variables"):
    checked_variable = st.selectbox("Select one explanatory variable:", df.columns[:-1])
    fig, ax = plt.subplots(figsize=(5, 3))
    ax.scatter(x=df[checked_variable], y=df["PRICE"], alpha=0.5)
    plt.xlabel(checked_variable)
    plt.ylabel("PRICE")
    st.pyplot(fig)

# Preprocessing Section
with st.expander("Data Preprocessing"):
    # Select the variables to exclude
    Features_NonUsed = st.multiselect(
        "Select the variables you will NOT use", df.columns[:-1]
    )
    df = df.drop(columns=Features_NonUsed)

    # Logarithmic transformation
    columns = st.columns(2)
    bool_log = columns[0].radio("Apply logarithmic transformation?", ("No", "Yes"))
    df_log = df.copy()
    if bool_log == "Yes":
        Log_Features = columns[1].multiselect(
            "Select features for logarithmic transformation", df.columns[:-1]
        )
        try:
            df_log[Log_Features] = np.log1p(df_log[Log_Features])
        except Exception as e:
            st.error(f"Log transformation error: {e}")

    # Standardization
    bool_std = columns[0].radio("Apply standardization?", ("No", "Yes"))
    df_std = df_log.copy()
    if bool_std == "Yes":
        Std_Features_NotUsed = columns[1].multiselect(
            "Select features to exclude from standardization", df.columns[:-1]
        )
        Std_Features_chosen = [
            name for name in df.columns[:-1] if name not in Std_Features_NotUsed
        ]
        scaler = StandardScaler()
        df_std[Std_Features_chosen] = scaler.fit_transform(df_std[Std_Features_chosen])

# Split the dataset into training and validation datasets
st.subheader("Split the dataset")
split_columns = st.columns(2)
test_size = split_columns[0].slider("Validation data size (ratio):", 0.1, 0.5, 0.2)
random_seed = split_columns[1].number_input(
    "Random seed:", min_value=0, step=1, value=42
)

X_train, X_val, Y_train, Y_val = train_test_split(
    df_std.drop(columns=["PRICE"]),
    df_std["PRICE"],
    test_size=test_size,
    random_state=random_seed,
)

# Model Training
regressor = LinearRegression()
regressor.fit(X_train, Y_train)
Y_pred_train = regressor.predict(X_train)
Y_pred_val = regressor.predict(X_val)

# Inverse transformation if logarithmic transformation was performed
if bool_log == "Yes" and "PRICE" in Log_Features:
    Y_pred_train, Y_pred_val = np.expm1(Y_pred_train), np.expm1(Y_pred_val)
    Y_train, Y_val = np.expm1(Y_train), np.expm1(Y_val)

# Model Evaluation Section
with st.expander("Model Evaluation"):
    # Model accuracy
    R2 = r2_score(Y_val, Y_pred_val)
    MAE = mean_absolute_error(Y_val, Y_pred_val)
    MSE = mean_squared_error(Y_val, Y_pred_val)

    st.write(f"RÂ² value: {R2:.2f}")
    st.write(f"Mean Absolute Error (MAE): {MAE:.2f}")
    st.write(f"Mean Squared Error (MSE): {MSE:.2f}")

    # Plot the results
    plot_columns = st.columns(2)
    show_train = plot_columns[0].radio(
        "Plot the training dataset result:", ("Yes", "No")
    )
    show_val = plot_columns[1].radio(
        "Plot the validation dataset result:", ("Yes", "No")
    )

    # Dynamic axis range
    range_columns = st.columns(2)
    x_min = range_columns[0].number_input("x_min:", value=0)
    x_max = range_columns[1].number_input(
        "x_max:",
        value=int(max(Y_train.max(), Y_val.max(), Y_pred_train.max(), Y_pred_val.max()))
        + 5,
    )

    y_min = range_columns[0].number_input("y_min:", value=0)
    y_max = range_columns[1].number_input(
        "y_max:",
        value=int(max(Y_train.max(), Y_val.max(), Y_pred_train.max(), Y_pred_val.max()))
        + 5,
    )

    # Plot the results
    fig = plt.figure(figsize=(5, 5))
    if show_train == "Yes":
        plt.scatter(Y_train, Y_pred_train, color="r", label="Training data", alpha=0.5)
    if show_val == "Yes":
        plt.scatter(Y_val, Y_pred_val, color="b", label="Validation data", alpha=0.5)
    plt.plot([x_min, x_max], [y_min, y_max], "k--", lw=2)
    plt.xlabel("Actual Prices")
    plt.ylabel("Predicted Prices")
    plt.xlim(x_min, x_max)
    plt.ylim(y_min, y_max)
    plt.legend()
    st.pyplot(fig)
```
ä¸‹è¨˜ã§å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨ãƒ»
```bash
streamlit run sample.py
```

```bash
~/my_repo/stremlit$ streamlit run sample.py

      ðŸ‘‹ Welcome to Streamlit!

      If youâ€™d like to receive helpful onboarding emails, news, offers, promotions,
      and the occasional swag, please enter your email address below. Otherwise,
      leave this field blank.

      Email:

  You can find our privacy policy at https://streamlit.io/privacy-policy

  Summary:
  - This open source library collects usage statistics.
  - We cannot see and do not store information contained inside Streamlit apps,
    such as text, charts, images, etc.
  - Telemetry data is stored in servers in the United States.
  - If you'd like to opt out, add the following to ~/.streamlit/config.toml,
    creating that file if necessary:

    [browser]
    gatherUsageStats = false


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.30.18.234:8501
```
ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã«æŽ¥ç¶šã—ã¦ã¿ã‚‹ã¨ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ã‚µãƒ¼ãƒãŒãŸã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/381629/e05d1315-c4a6-4ee1-975d-186257cbc2c6.png)

## Githubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
ã€€ä¸‹è¨˜ã®ã‚ˆã†ã«streamlitã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¯ãƒ©ã‚¦ãƒ‰ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚
 ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Githubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¯ãƒ©ã‚¦ãƒ‰ã«ã‚‚ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
 
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/381629/b882296c-5c9a-47e3-b999-56c47fa1483d.png)

ä¸‹è¨˜ã§GitHubã®URLã¨ã‚¢ãƒ—ãƒªåã‚’å…¥åŠ›ã™ã‚‹ã¨ç°¡å˜ã«Githubä¸Šã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã‚¯ãƒ©ã‚¦ãƒ‰ä¸Šã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/381629/65db04f3-a087-4415-9abb-c2e9f28e9ebe.png)

ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

https://samplepy-life-tech.streamlit.app/

ãªãŠã€streamlit.app ã®æ¨©å¨ã‚µãƒ¼ãƒã‚„SSLã®è¨¼æ˜Žæ›¸ç®¡ç†ãªã©ã‚‚stremlitå´ãŒç®¡ç†ã—ã¦ã„ã‚‹ã®ã§ãƒ¦ãƒ¼ã‚¶å´ã¯æ„è­˜ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

â€»CI/CDæ©Ÿèƒ½
ã€€ãªãŠã€Githubä¸Šã‚’æ›´æ–°ã™ã‚‹ã¨ãã‚Œã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã‚¢ãƒ—ãƒªãŒãƒ“ãƒ«ãƒ‰ã•ã‚ŒãªãŠã—ã¾ã™ã€‚stremlitã‚¯ãƒ©ã‚¦ãƒ‰å†…ã§Githubã®æ›´æ–°ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¦CI/CDã®ä»•çµ„ã¿ãŒå‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚


## æœ€å¾Œã«
ã€€ãƒ‡ãƒ¼ã‚¿è§£æžã®å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦è»½é‡ãªstreamlitãŒæ³¨ç›®ã•ã‚Œã¦ã„ã¾ã™ã€‚å®Ÿéš›ã«ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¦ã¿ã¦éžå¸¸ã«è»½é‡ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ã¾ãŸã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¯ãƒ©ã‚¦ãƒ‰ã«ã‚‚ç°¡å˜ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚

